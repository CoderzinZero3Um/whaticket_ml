'use strict';const a563_0x4b6038=a563_0x5f45;(function(_0x4b6761,_0x43f605){const _0xb1440b=a563_0x5f45,_0x5b5f4c=_0x4b6761();while(!![]){try{const _0xcf2a09=-parseInt(_0xb1440b(0x142))/0x1+-parseInt(_0xb1440b(0x146))/0x2*(-parseInt(_0xb1440b(0x153))/0x3)+parseInt(_0xb1440b(0x138))/0x4+parseInt(_0xb1440b(0x144))/0x5*(-parseInt(_0xb1440b(0x130))/0x6)+parseInt(_0xb1440b(0x157))/0x7+-parseInt(_0xb1440b(0x14a))/0x8+-parseInt(_0xb1440b(0x147))/0x9*(-parseInt(_0xb1440b(0x143))/0xa);if(_0xcf2a09===_0x43f605)break;else _0x5b5f4c['push'](_0x5b5f4c['shift']());}catch(_0x3e985b){_0x5b5f4c['push'](_0x5b5f4c['shift']());}}}(a563_0x127f,0xa2ba3));function a563_0x127f(){const _0x2f6f98=['defineProperty','test','yup','6298292eRJGHY','message','findOne','Check-unique-name','writable','shape','upsert','hasOwnProperty','getOwnPropertyDescriptor','__importStar','default','get','483870LmSKXd','__esModule','ASC','user','ERR_QUEUE_NAME_ALREADY_EXISTS','__createBinding','../../errors/AppError','required','1112928oDNxaB','all','../../models/User','string','asc','validate','../../models/Chatbot','Não\x20é\x20permitido\x20alterar\x20registros\x20de\x20outra\x20empresa','ERR_QUEUE_INVALID_NAME','reload','96758caVZek','226510JIasFH','40IiQrAX','prototype','82yqKHfo','36yOgUmR','Check-color-exists','create','7311400PdwQqc','chatbots','update','ERR_QUEUE_INVALID_COLOR','companyId','sequelize','findIndex','./ShowQueueService','call','77106HmlCVx'];a563_0x127f=function(){return _0x2f6f98;};return a563_0x127f();}function a563_0x5f45(_0x1e9602,_0x19a228){const _0x127faa=a563_0x127f();return a563_0x5f45=function(_0x5f45c0,_0x599675){_0x5f45c0=_0x5f45c0-0x127;let _0x2f0352=_0x127faa[_0x5f45c0];return _0x2f0352;},a563_0x5f45(_0x1e9602,_0x19a228);}var __createBinding=this&&this[a563_0x4b6038(0x135)]||(Object['create']?function(_0x141f4f,_0x1129a5,_0x19b5cd,_0x2a4962){const _0x5d6f8f=a563_0x4b6038;if(_0x2a4962===undefined)_0x2a4962=_0x19b5cd;var _0x4bd6f3=Object[_0x5d6f8f(0x12c)](_0x1129a5,_0x19b5cd);(!_0x4bd6f3||(_0x5d6f8f(0x12f)in _0x4bd6f3?!_0x1129a5[_0x5d6f8f(0x131)]:_0x4bd6f3[_0x5d6f8f(0x128)]||_0x4bd6f3['configurable']))&&(_0x4bd6f3={'enumerable':!![],'get':function(){return _0x1129a5[_0x19b5cd];}}),Object[_0x5d6f8f(0x154)](_0x141f4f,_0x2a4962,_0x4bd6f3);}:function(_0x496e78,_0x54bfda,_0x4244db,_0x3d74f){if(_0x3d74f===undefined)_0x3d74f=_0x4244db;_0x496e78[_0x3d74f]=_0x54bfda[_0x4244db];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a563_0x4b6038(0x149)]?function(_0x5952a5,_0x16d16e){const _0x226110=a563_0x4b6038;Object[_0x226110(0x154)](_0x5952a5,_0x226110(0x12e),{'enumerable':!![],'value':_0x16d16e});}:function(_0x313356,_0x1bf360){const _0x16fbaf=a563_0x4b6038;_0x313356[_0x16fbaf(0x12e)]=_0x1bf360;}),__importStar=this&&this[a563_0x4b6038(0x12d)]||function(_0x5e3dfa){const _0x41ce96=a563_0x4b6038;if(_0x5e3dfa&&_0x5e3dfa[_0x41ce96(0x131)])return _0x5e3dfa;var _0x5d901c={};if(_0x5e3dfa!=null){for(var _0x4ff544 in _0x5e3dfa)if(_0x4ff544!=='default'&&Object[_0x41ce96(0x145)][_0x41ce96(0x12b)][_0x41ce96(0x152)](_0x5e3dfa,_0x4ff544))__createBinding(_0x5d901c,_0x5e3dfa,_0x4ff544);}return __setModuleDefault(_0x5d901c,_0x5e3dfa),_0x5d901c;},__importDefault=this&&this['__importDefault']||function(_0x2dfdc8){return _0x2dfdc8&&_0x2dfdc8['__esModule']?_0x2dfdc8:{'default':_0x2dfdc8};};Object[a563_0x4b6038(0x154)](exports,a563_0x4b6038(0x131),{'value':!![]});const sequelize_1=require(a563_0x4b6038(0x14f)),Yup=__importStar(require(a563_0x4b6038(0x156))),AppError_1=__importDefault(require(a563_0x4b6038(0x136))),Chatbot_1=__importDefault(require(a563_0x4b6038(0x13e))),Queue_1=__importDefault(require('../../models/Queue')),ShowQueueService_1=__importDefault(require(a563_0x4b6038(0x151))),User_1=__importDefault(require(a563_0x4b6038(0x13a))),UpdateQueueService=async(_0x3cfd96,_0x509823,_0x1aeb7a)=>{const _0x483302=a563_0x4b6038,{color:_0x3ddd84,name:_0x124c97,chatbots:_0x33afa8}=_0x509823,_0x545699=Yup['object']()[_0x483302(0x129)]({'name':Yup[_0x483302(0x13b)]()['min'](0x2,_0x483302(0x140))[_0x483302(0x155)](_0x483302(0x127),_0x483302(0x134),async _0x16a645=>{const _0x529ac1=_0x483302;if(_0x16a645){const _0x4280e0=await Queue_1[_0x529ac1(0x12e)][_0x529ac1(0x159)]({'where':{'name':_0x16a645,'id':{[sequelize_1['Op']['ne']]:_0x3cfd96},'companyId':_0x1aeb7a}});return!_0x4280e0;}return!![];}),'color':Yup[_0x483302(0x13b)]()[_0x483302(0x137)]('ERR_QUEUE_INVALID_COLOR')[_0x483302(0x155)]('Check-color',_0x483302(0x14d),async _0x21b6f6=>{const _0x3b95f8=_0x483302;if(_0x21b6f6){const _0x447572=/^#[0-9a-f]{3,6}$/i;return _0x447572[_0x3b95f8(0x155)](_0x21b6f6);}return!![];})['test'](_0x483302(0x148),'ERR_QUEUE_COLOR_ALREADY_EXISTS',async _0x322d37=>{const _0x59cbb5=_0x483302;if(_0x322d37){const _0x2e1d4d=await Queue_1[_0x59cbb5(0x12e)][_0x59cbb5(0x159)]({'where':{'color':_0x322d37,'id':{[sequelize_1['Op']['ne']]:_0x3cfd96},'companyId':_0x1aeb7a}});return!_0x2e1d4d;}return!![];})});try{await _0x545699[_0x483302(0x13d)]({'color':_0x3ddd84,'name':_0x124c97});}catch(_0xff28e9){throw new AppError_1[(_0x483302(0x12e))](_0xff28e9[_0x483302(0x158)]);}const _0x1cb7f8=await(0x0,ShowQueueService_1[_0x483302(0x12e)])(_0x3cfd96,_0x1aeb7a);if(_0x1cb7f8[_0x483302(0x14e)]!==_0x1aeb7a)throw new AppError_1[(_0x483302(0x12e))](_0x483302(0x13f));return _0x33afa8&&(await Promise[_0x483302(0x139)](_0x33afa8['map'](async _0x5aa0a2=>{const _0x1ef5c1=_0x483302;await Chatbot_1[_0x1ef5c1(0x12e)][_0x1ef5c1(0x12a)]({..._0x5aa0a2,'queueId':_0x1cb7f8['id']});})),await Promise[_0x483302(0x139)](_0x1cb7f8[_0x483302(0x14b)]['map'](async _0x1e303f=>{const _0x4924a3=_0x483302,_0x30d7e4=_0x33afa8[_0x4924a3(0x150)](_0x509f13=>_0x509f13['id']===_0x1e303f['id']);_0x30d7e4===-0x1&&await Chatbot_1['default']['destroy']({'where':{'id':_0x1e303f['id']}});}))),await _0x1cb7f8[_0x483302(0x14c)](_0x509823),await _0x1cb7f8[_0x483302(0x141)]({'include':[{'model':Chatbot_1[_0x483302(0x12e)],'as':'chatbots','include':[{'model':User_1[_0x483302(0x12e)],'as':_0x483302(0x133)}],'order':[[{'model':Chatbot_1[_0x483302(0x12e)],'as':_0x483302(0x14b)},'id',_0x483302(0x13c)],['id',_0x483302(0x132)]]}],'order':[[{'model':Chatbot_1[_0x483302(0x12e)],'as':_0x483302(0x14b)},'id',_0x483302(0x13c)],['id',_0x483302(0x132)]]}),_0x1cb7f8;};exports[a563_0x4b6038(0x12e)]=UpdateQueueService;