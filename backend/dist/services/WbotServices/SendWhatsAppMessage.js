'use strict';const a652_0xd0bab1=a652_0x59aa;(function(_0x1b4769,_0x4c0727){const _0x4b6942=a652_0x59aa,_0x26fc15=_0x1b4769();while(!![]){try{const _0x3cadd7=parseInt(_0x4b6942(0xfc))/0x1*(-parseInt(_0x4b6942(0xfd))/0x2)+parseInt(_0x4b6942(0xd4))/0x3*(-parseInt(_0x4b6942(0xd6))/0x4)+-parseInt(_0x4b6942(0xd5))/0x5+-parseInt(_0x4b6942(0xf3))/0x6+-parseInt(_0x4b6942(0xf1))/0x7*(parseInt(_0x4b6942(0xde))/0x8)+parseInt(_0x4b6942(0xef))/0x9*(parseInt(_0x4b6942(0xd1))/0xa)+-parseInt(_0x4b6942(0xce))/0xb*(-parseInt(_0x4b6942(0xdb))/0xc);if(_0x3cadd7===_0x4c0727)break;else _0x26fc15['push'](_0x26fc15['shift']());}catch(_0x3778be){_0x26fc15['push'](_0x26fc15['shift']());}}}(a652_0x5a16,0x47e9d));var __createBinding=this&&this[a652_0xd0bab1(0xf4)]||(Object[a652_0xd0bab1(0xe0)]?function(_0x14ed95,_0x48d17b,_0x53c1cd,_0x1417d5){const _0x19287f=a652_0xd0bab1;if(_0x1417d5===undefined)_0x1417d5=_0x53c1cd;var _0x4f737f=Object[_0x19287f(0xff)](_0x48d17b,_0x53c1cd);(!_0x4f737f||('get'in _0x4f737f?!_0x48d17b[_0x19287f(0xe6)]:_0x4f737f[_0x19287f(0xf7)]||_0x4f737f[_0x19287f(0xcd)]))&&(_0x4f737f={'enumerable':!![],'get':function(){return _0x48d17b[_0x53c1cd];}}),Object[_0x19287f(0xcc)](_0x14ed95,_0x1417d5,_0x4f737f);}:function(_0x3b2a1d,_0x17f7fa,_0x3cfe5d,_0x23346d){if(_0x23346d===undefined)_0x23346d=_0x3cfe5d;_0x3b2a1d[_0x23346d]=_0x17f7fa[_0x3cfe5d];}),__setModuleDefault=this&&this[a652_0xd0bab1(0xca)]||(Object[a652_0xd0bab1(0xe0)]?function(_0x356327,_0x32fd6e){const _0x2a439d=a652_0xd0bab1;Object[_0x2a439d(0xcc)](_0x356327,_0x2a439d(0xf6),{'enumerable':!![],'value':_0x32fd6e});}:function(_0x44e5eb,_0x22d250){const _0xe5342d=a652_0xd0bab1;_0x44e5eb[_0xe5342d(0xf6)]=_0x22d250;}),__importStar=this&&this[a652_0xd0bab1(0xe7)]||function(_0xf70d44){const _0x2bd01f=a652_0xd0bab1;if(_0xf70d44&&_0xf70d44[_0x2bd01f(0xe6)])return _0xf70d44;var _0x5e429d={};if(_0xf70d44!=null){for(var _0x53fcdd in _0xf70d44)if(_0x53fcdd!=='default'&&Object[_0x2bd01f(0xfb)]['hasOwnProperty'][_0x2bd01f(0xcf)](_0xf70d44,_0x53fcdd))__createBinding(_0x5e429d,_0xf70d44,_0x53fcdd);}return __setModuleDefault(_0x5e429d,_0xf70d44),_0x5e429d;},__importDefault=this&&this['__importDefault']||function(_0x1be029){const _0x4041ca=a652_0xd0bab1;return _0x1be029&&_0x1be029[_0x4041ca(0xe6)]?_0x1be029:{'default':_0x1be029};};function a652_0x59aa(_0x24e13f,_0x34eefb){const _0x5a1665=a652_0x5a16();return a652_0x59aa=function(_0x59aad4,_0x26751d){_0x59aad4=_0x59aad4-0xc9;let _0x34745c=_0x5a1665[_0x59aad4];return _0x34745c;},a652_0x59aa(_0x24e13f,_0x34eefb);}function a652_0x5a16(){const _0x15488f=['193406JQMXEk','4UjWbCW','parse','getOwnPropertyDescriptor','erro\x20ao\x20enviar\x20mensagem\x20na\x20company\x20','__setModuleDefault','extendedTextMessage','defineProperty','configurable','11GGCvyo','call','split','9740mrHejT','log','conversation','15BRVDmq','1821835uXzoBk','2732oRqOHh','remoteJid','FN:','findByPk','../../models/Contact','19886988AhaGxC','findOne','@whiskeysockets/baileys','24obcBFa','number','create','lodash','sendMessage','replace','update','\x20-\x20','__esModule','__importStar','name','../../models/Message','TEL;type=CELL;waid=','contactId','captureException','message','g.us','468UNDrKV','BEGIN:VCARD\x0a','1093211GHYiaf','../../errors/AppError','1141362qwPcuQ','__createBinding','delay','default','writable','dataJson','../../helpers/Mustache','ERR_SENDING_WAPP_MSG','prototype'];a652_0x5a16=function(){return _0x15488f;};return a652_0x5a16();}Object[a652_0xd0bab1(0xcc)](exports,a652_0xd0bab1(0xe6),{'value':!![]});const baileys_1=require(a652_0xd0bab1(0xdd)),Sentry=__importStar(require('@sentry/node')),AppError_1=__importDefault(require(a652_0xd0bab1(0xf2))),GetTicketWbot_1=__importDefault(require('../../helpers/GetTicketWbot')),Message_1=__importDefault(require(a652_0xd0bab1(0xe9))),Contact_1=__importDefault(require(a652_0xd0bab1(0xda))),lodash_1=require(a652_0xd0bab1(0xe1)),Mustache_1=__importDefault(require(a652_0xd0bab1(0xf9))),SendWhatsAppMessage=async({body:_0x93bd53,ticket:_0x1122ff,quotedMsg:_0x164f8f,msdelay:_0x49f2f8,vCard:_0x3e788c,isForwarded:isForwarded=![]})=>{const _0x4d48f0=a652_0xd0bab1;let _0x30a7e={};const _0x39e844=await(0x0,GetTicketWbot_1[_0x4d48f0(0xf6)])(_0x1122ff),_0x332931=await Contact_1['default'][_0x4d48f0(0xd9)](_0x1122ff[_0x4d48f0(0xeb)]);let _0x2fec35;_0x332931[_0x4d48f0(0xd7)]&&_0x332931[_0x4d48f0(0xd7)]!==''&&_0x332931[_0x4d48f0(0xd7)]['includes']('@')?_0x2fec35=_0x332931['remoteJid']:_0x2fec35=_0x332931[_0x4d48f0(0xdf)]+'@'+(_0x1122ff['isGroup']?_0x4d48f0(0xee):'s.whatsapp.net');if(_0x164f8f){const _0x5f4bfe=await Message_1['default'][_0x4d48f0(0xdc)]({'where':{'id':_0x164f8f['id']}});if(_0x5f4bfe){const _0x1f1fc0=JSON[_0x4d48f0(0xfe)](_0x5f4bfe[_0x4d48f0(0xf8)]);_0x1f1fc0[_0x4d48f0(0xed)][_0x4d48f0(0xcb)]!==undefined?_0x30a7e={'quoted':{'key':_0x1f1fc0['key'],'message':{'extendedTextMessage':_0x1f1fc0[_0x4d48f0(0xed)][_0x4d48f0(0xcb)]}}}:_0x30a7e={'quoted':{'key':_0x1f1fc0['key'],'message':{'conversation':_0x1f1fc0['message'][_0x4d48f0(0xd3)]}}};}}if(!(0x0,lodash_1['isNil'])(_0x3e788c)){const _0x5d1a79=_0x3e788c['number'],_0x3d662d=_0x3e788c[_0x4d48f0(0xe8)][_0x4d48f0(0xd0)]('\x20')[0x0],_0x221c84=String(_0x3e788c[_0x4d48f0(0xe8)])[_0x4d48f0(0xe3)](_0x3e788c[_0x4d48f0(0xe8)][_0x4d48f0(0xd0)]('\x20')[0x0],''),_0x3b6b8f=_0x4d48f0(0xf0)+'VERSION:3.0\x0a'+('N:'+_0x221c84+';'+_0x3d662d+';;;\x0a')+(_0x4d48f0(0xd8)+_0x3e788c[_0x4d48f0(0xe8)]+'\x0a')+(_0x4d48f0(0xea)+_0x5d1a79+':+'+_0x5d1a79+'\x0a')+'END:VCARD';try{await(0x0,baileys_1[_0x4d48f0(0xf5)])(_0x49f2f8);const _0x4526b3=await _0x39e844[_0x4d48f0(0xe2)](_0x2fec35,{'contacts':{'displayName':''+_0x3e788c[_0x4d48f0(0xe8)],'contacts':[{'vcard':_0x3b6b8f}]}});return await _0x1122ff[_0x4d48f0(0xe4)]({'lastMessage':(0x0,Mustache_1['default'])(_0x3b6b8f,_0x1122ff),'imported':null}),_0x4526b3;}catch(_0x59aeb9){Sentry[_0x4d48f0(0xec)](_0x59aeb9),console[_0x4d48f0(0xd2)](_0x59aeb9);throw new AppError_1[(_0x4d48f0(0xf6))](_0x4d48f0(0xfa));}};try{await(0x0,baileys_1['delay'])(_0x49f2f8);const _0x51eb57=await _0x39e844[_0x4d48f0(0xe2)](_0x2fec35,{'text':(0x0,Mustache_1[_0x4d48f0(0xf6)])(_0x93bd53,_0x1122ff),'contextInfo':{'forwardingScore':isForwarded?0x2:0x0,'isForwarded':isForwarded?!![]:![]}},{..._0x30a7e});return await _0x1122ff[_0x4d48f0(0xe4)]({'lastMessage':(0x0,Mustache_1['default'])(_0x93bd53,_0x1122ff),'imported':null}),_0x51eb57;}catch(_0x5563b8){console['log'](_0x4d48f0(0xc9)+_0x1122ff['companyId']+_0x4d48f0(0xe5),_0x2fec35),Sentry[_0x4d48f0(0xec)](_0x5563b8),console[_0x4d48f0(0xd2)](_0x5563b8);throw new AppError_1[(_0x4d48f0(0xf6))](_0x4d48f0(0xfa));}};exports[a652_0xd0bab1(0xf6)]=SendWhatsAppMessage;